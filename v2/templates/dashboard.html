<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Any-to-Any Conversion Studio</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}?v=9">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/liquid-glass.css') }}?v=4">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/targets.css') }}?v=2">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/agents.css') }}?v=1">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/jobs.css') }}?v=1">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/config.css') }}?v=1">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/credentials.css') }}?v=1">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Selection Modals -->
    <div id="sourceSelectionModal" class="selection-modal">
        <div class="selection-modal-content">
            <div class="selection-modal-header">
                <h3>Select Source</h3>
                <button class="selection-modal-close" onclick="closeSelectionModal('source')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            <div class="selection-modal-body">
                <div class="selection-grid" id="sourceSelectionGrid">
                    <!-- Source cards will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <div id="targetSelectionModal" class="selection-modal">
        <div class="selection-modal-content">
            <div class="selection-modal-header">
                <h3>Select Target</h3>
                <button class="selection-modal-close" onclick="closeSelectionModal('target')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            <div class="selection-modal-body">
                <div class="selection-grid" id="targetSelectionGrid">
                    <!-- Target cards will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- SVG Filters for Liquid Glass Effect -->
    <svg style="position: absolute; width: 0; height: 0;">
        <defs>
            <filter id="liquid-displacement">
                <feTurbulence type="fractalNoise" baseFrequency="0.01" numOctaves="2" result="turbulence" />
                <feColorMatrix in="turbulence" type="saturate" values="0" result="desaturatedTurbulence" />
                <feComponentTransfer in="desaturatedTurbulence" result="discrete">
                    <feFuncA type="discrete" tableValues="0 .2 .4 .6 .8 1" />
                </feComponentTransfer>
                <feGaussianBlur in="discrete" stdDeviation="1" result="blur" />
                <feDisplacementMap in="SourceGraphic" in2="blur" scale="2" xChannelSelector="R" yChannelSelector="G" />
            </filter>
        </defs>
    </svg>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <svg class="logo-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 9l3 3-3 3m5 0h3M5 20h14a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                    </svg>
                    <div class="logo-text">
                        <h1>ConvStudio</h1>
                        <p>Any-to-Any Converter</p>
                    </div>
                </div>
            </div>
            
            <nav class="sidebar-nav">
                <a href="#home" class="nav-item active" data-page="home">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>
                    </svg>
                    <span>Home</span>
                </a>
                
                <a href="#sources" class="nav-item" data-page="sources">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"/>
                    </svg>
                    <span>Sources</span>
                </a>
                
                <a href="#targets" class="nav-item" data-page="targets">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8h2a2 2 0 012 2v6a2 2 0 01-2 2h-2v4l-3-3-3 3v-4H9a2 2 0 01-2-2v-6a2 2 0 012-2h2m0-4v4m0 0h6m-6 0H9"/>
                    </svg>
                    <span>Targets</span>
                </a>
                
                <a href="#agents" class="nav-item" data-page="agents">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
                    </svg>
                    <span>Agents</span>
                </a>
                
                <a href="#jobs" class="nav-item" data-page="jobs">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"/>
                    </svg>
                    <span>Jobs</span>
                    <span class="nav-badge">2</span>
                </a>
                
                <div class="nav-divider"></div>
                
                <a href="#settings" class="nav-item" data-page="settings">
                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                    </svg>
                    <span>Settings</span>
                </a>
            </nav>
            
            <div class="sidebar-footer">
                <div class="user-profile">
                    <div class="user-avatar">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                        </svg>
                    </div>
                    <div class="user-info">
                        <p class="user-name">Admin User</p>
                        <p class="user-role">Administrator</p>
                    </div>
                </div>
            </div>
        </aside>
        
        <!-- Main Content -->
        <main class="main-content">
            <!-- Top Bar -->
            <header class="top-bar">
                <div class="top-bar-left">
                    <!-- <h2 id="pageTitle">Dashboard</h2>
                    <span class="breadcrumb">Home</span> -->
                </div>
                <div class="top-bar-right">
                    <button class="btn btn-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"/>
                        </svg>
                    </button>
                    <span class="date-time" id="currentDateTime">March 12, 2025</span>
                </div>
            </header>
            
            <!-- Page Content -->
            <div class="page-content" id="pageContent">
                <!-- Home/Dashboard Page -->
                <div id="homePage" class="page active">
                    <!-- Stats Cards -->
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-header">
                                <h3>Total Conversions</h3>
                                <span class="stat-trend positive">↑ 15%</span>
                            </div>
                            <div class="stat-value">1,248</div>
                            <div class="stat-subtitle">Processed this month</div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-header">
                                <h3>Active Jobs</h3>
                                <span class="stat-badge">Live</span>
                            </div>
                            <div class="stat-value">2</div>
                            <div class="stat-subtitle">Currently running</div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-header">
                                <h3>Success Rate</h3>
                                <span class="stat-trend positive">↑ 3.2%</span>
                            </div>
                            <div class="stat-value">87.5%</div>
                            <div class="stat-subtitle">Last 30 days</div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-header">
                                <h3>Configured Sources</h3>
                            </div>
                            <div class="stat-value">5</div>
                            <div class="stat-subtitle">3 active sources</div>
                        </div>
                    </div>
                    
                    <!-- Conversion Overview -->
                    <div class="dashboard-row">
                        <div class="card conversion-overview">
                            <div class="card-header">
                                <h3>Conversion Overview</h3>
                                <button class="btn btn-sm">View All</button>
                            </div>
                            <div class="card-body">
                                <div class="conversion-chart">
                                    <div class="chart-placeholder">
                                        <svg viewBox="0 0 200 100" class="mini-chart">
                                            <polyline points="0,80 20,70 40,75 60,60 80,65 100,50 120,55 140,45 160,50 180,40 200,45" 
                                                     fill="none" stroke="#4f46e5" stroke-width="2"/>
                                        </svg>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card recent-activity">
                            <div class="card-header">
                                <h3>Recent Jobs</h3>
                                <button class="btn btn-sm">See All</button>
                            </div>
                            <div class="card-body">
                                <div class="activity-list" id="recentJobsList">
                                    <!-- Jobs will be loaded here -->
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Quick Actions -->
                    <div class="quick-actions">
                        <h3>Quick Actions</h3>
                        <div class="action-grid">
                            <button class="action-card" onclick="showNewJobModal()">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                                </svg>
                                <span>New Conversion Job</span>
                            </button>
                            <button class="action-card" onclick="navigateToPage('sources')">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"/>
                                </svg>
                                <span>Configure Sources</span>
                            </button>
                            <button class="action-card" onclick="navigateToPage('targets')">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"/>
                                </svg>
                                <span>Configure Targets</span>
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Sources Page -->
                <div id="sourcesPage" class="page">
                    <div class="page-header">
                        <div>
                            <!-- <h3>Sources</h3> -->
                            <p>Manage source repositories and folders for conversion</p>
                        </div>
                        <button class="btn btn-primary liquid-glass" onclick="showAddSourceModal()">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                            </svg>
                            Add Source
                        </button>
                    </div>
                    
                    <!-- Sources Table -->
                    <div class="sources-table-container liquid-glass">
                        <table class="sources-table">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Type</th>
                                    <th>Location</th>
                                    <th>Files</th>
                                    <th>Created</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="sourcesTableBody">
                                <!-- Sources will be loaded here -->
                            </tbody>
                        </table>
                        <div id="noSourcesMessage" class="empty-state liquid-glass" style="display: none;">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"/>
                            </svg>
                            <h4>No sources configured</h4>
                            <p>Add your first source to get started</p>
                            <button class="btn btn-primary liquid-glass" onclick="showAddSourceModal()">Add Source</button>
                        </div>
                    </div>
                </div>
                
                <!-- Targets Page -->
                <div id="targetsPage" class="page">
                    <div class="page-header">
                        <div>
                            <!-- <h3>Targets</h3> -->
                            <p>Manage target platforms and conversion prompts</p>
                        </div>
                        <button class="btn btn-primary liquid-glass" onclick="showAddTargetModal()">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                            </svg>
                            Add Target
                        </button>
                    </div>
                    
                    <div class="targets-container">
                        <div id="targetsGrid" class="targets-grid">
                            <!-- Targets will be loaded here -->
                        </div>
                        <div id="noTargetsMessage" class="empty-state liquid-glass" style="display: none;">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8h2a2 2 0 012 2v6a2 2 0 01-2 2h-2v4l-3-3-3 3v-4H9a2 2 0 01-2-2v-6a2 2 0 012-2h2m0-4v4m0 0h6m-6 0H9"/>
                            </svg>
                            <h4>No targets configured</h4>
                            <p>Add your first target to get started</p>
                            <button class="btn btn-primary liquid-glass" onclick="showAddTargetModal()">Add Target</button>
                        </div>
                    </div>
                </div>
                
                <!-- Agents Page -->
                <div id="agentsPage" class="page">
                    <div class="page-header">
                        <div>
                            <!-- <h3>AI Agents</h3> -->
                            <p>Configure and manage AI agents for automated conversions</p>
                        </div>
                        <button class="btn btn-primary liquid-glass" onclick="showAddAgentModal()">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                            </svg>
                            Add Agent
                        </button>
                    </div>
                    
                    <div class="agents-container" id="agentsContainer">
                        <!-- Agents will be loaded here dynamically -->
                    </div>
                </div>
                
                <!-- Jobs Page -->
                <div id="jobsPage" class="page">
                    <div class="page-header">
                        <div>
                            <!-- <h3>Conversion Jobs</h3> -->
                            <p>View and manage all conversion jobs</p>
                        </div>
                        <button class="btn btn-primary" onclick="showNewJobModal()">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                            </svg>
                            New Job
                        </button>
                    </div>
                    
                    <div class="jobs-filters">
                        <input type="search" placeholder="Search jobs..." class="search-input">
                        <select class="filter-select">
                            <option>All Status</option>
                            <option>Running</option>
                            <option>Completed</option>
                            <option>Failed</option>
                        </select>
                        <select class="filter-select">
                            <option>Sort By</option>
                            <option>Newest First</option>
                            <option>Oldest First</option>
                            <option>Name</option>
                        </select>
                    </div>
                    
                    <div class="jobs-table" id="jobsTableContainer">
                        <table>
                            <thead>
                                <tr>
                                    <th>Job Name</th>
                                    <th>Source</th>
                                    <th>Target</th>
                                    <th>Status</th>
                                    <th>Progress</th>
                                    <th>Created</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="jobsTableBody">
                                <!-- Jobs will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- Inline Create Job Form -->
                    <div class="inline-create-job" id="inlineCreateJob" style="display: none;">
                        <div class="create-job-header">
                            <h3>Create New Migration Job</h3>
                            <p>Quick setup with @ mentions</p>
                        </div>
                        
                        <div class="create-job-form simplified">
                            <div class="form-group">
                                <label>Job Name</label>
                                <input type="text" id="inlineJobName" placeholder="Spring to Rust Migration" class="form-input liquid-glass">
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Source</label>
                                    <button type="button" class="selection-button" id="sourceSelectionBtn" onclick="showSourceSelection()">
                                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M3 7V17C3 18.1046 3.89543 19 5 19H19C20.1046 19 21 18.1046 21 17V9C21 7.89543 20.1046 7 19 7H13L11 5H5C3.89543 5 3 5.89543 3 7Z"/>
                                        </svg>
                                        <span id="sourceSelectionText">Choose source...</span>
                                    </button>
                                </div>
                                
                                <div class="form-group">
                                    <label>Target</label>
                                    <button type="button" class="selection-button" id="targetSelectionBtn" onclick="showTargetSelection()">
                                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M17 8h2a2 2 0 012 2v6a2 2 0 01-2 2h-2v4l-3-3-3 3v-4H9a2 2 0 01-2-2v-6a2 2 0 012-2h2m0-4v4m0 0h6m-6 0H9"/>
                                        </svg>
                                        <span id="targetSelectionText">Choose target...</span>
                                    </button>
                                </div>
                            </div>
                            
                            
                            <div class="form-actions">
                                <button class="btn btn-secondary" onclick="cancelInlineJob()">Cancel</button>
                                <button class="btn btn-primary" onclick="saveInlineJob()">
                                    <span id="inlineSaveJobBtnText">Create Job</span>
                                    <div class="spinner" id="inlineSaveJobSpinner" style="display: none;"></div>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Inline Job Detail View -->
                    <div class="inline-job-detail" id="inlineJobDetail" style="display: none;">
                        <div class="timeline-header">
                            <button class="btn btn-secondary" onclick="closeInlineJobDetail()" style="position: absolute; right: 20px; top: 20px;">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" style="width: 16px; height: 16px; margin-right: 5px;">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m0 7h18"/>
                                </svg>
                                Back to Jobs
                            </button>
                            <div class="timeline-title-section">
                                <div class="timeline-icon">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M13 10V3L4 14h7v7l9-11h-7z"/>
                                    </svg>
                                </div>
                                <div>
                                    <h2 id="inlineJobDetailName">Migration Timeline</h2>
                                    <p id="inlineJobDetailDescription">Track your migration progress</p>
                                </div>
                            </div>
                        </div>
                        
                        
                        <div class="timeline-body" id="timelineTabContent">
                            <div class="timeline-meta">
                                <div class="meta-pill">
                                    <svg class="meta-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M3 7V17C3 18.1046 3.89543 19 5 19H19C20.1046 19 21 18.1046 21 17V9C21 7.89543 20.1046 7 19 7H13L11 5H5C3.89543 5 3 5.89543 3 7Z"/>
                                    </svg>
                                    <span id="inlineJobDetailSource">Source</span>
                                </div>
                                <div class="meta-pill">
                                    <svg class="meta-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M17 8h2a2 2 0 012 2v6a2 2 0 01-2 2h-2v4l-3-3-3 3v-4H9a2 2 0 01-2-2v-6a2 2 0 012-2h2m0-4v4m0 0h6m-6 0H9"/>
                                    </svg>
                                    <span id="inlineJobDetailTarget">Target</span>
                                </div>
                                <div class="meta-pill">
                                    <svg class="meta-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                                    </svg>
                                    <span id="inlineJobDetailCreated">Created</span>
                                </div>
                            </div>
                            
                            <div id="inlineJobDetailCredentials" style="display: none; margin: 1.5rem 0;">
                                <!-- Linked credentials will be shown here -->
                            </div>
                            
                            <div class="timeline-container" id="inlineJobStagesContainer">
                                <!-- Timeline items will be populated here -->
                            </div>
                        </div>
                        
                    </div>
                </div>
                
                <!-- Settings Page -->
                <div id="settingsPage" class="page">
                    <div class="page-header">
                        <div>
                            <!-- <h3>Settings</h3> -->
                            <p>Manage credentials, connections, and preferences</p>
                        </div>
                    </div>
                    
                    <div class="settings-tabs">
                        <div class="settings-tab-buttons">
                            <button class="settings-tab-button active" onclick="switchSettingsTab('credentials')">
                                <span class="tab-icon">🔑</span>
                                Credentials
                            </button>
                            <button class="settings-tab-button" onclick="switchSettingsTab('connections')">
                                <span class="tab-icon">🔌</span>
                                Connections
                            </button>
                        </div>
                        
                        <!-- Credentials Tab -->
                        <div class="settings-tab-content active" id="credentialsTab">
                            <div class="credentials-header">
                                <h4>Manage Credentials</h4>
                                <button class="btn btn-primary" onclick="showAddCredentialModal()">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" style="width: 16px; height: 16px; margin-right: 5px;">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                                    </svg>
                                    Add Credential
                                </button>
                            </div>
                            
                            <div class="credentials-grid" id="credentialsGrid">
                                <!-- Credentials will be loaded here -->
                            </div>
                            
                            <div class="empty-state" id="credentialsEmpty" style="display: none;">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"/>
                                </svg>
                                <h5>No Credentials Yet</h5>
                                <p>Add your first credential to get started</p>
                                <button class="btn btn-primary" onclick="showAddCredentialModal()">Add Credential</button>
                            </div>
                        </div>
                        
                        <!-- Connections Tab -->
                        <div class="settings-tab-content" id="connectionsTab">
                            <div class="connections-header">
                                <h4>Connection Status</h4>
                                <button class="btn btn-secondary" onclick="testAllConnections()">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" style="width: 16px; height: 16px; margin-right: 5px;">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                                    </svg>
                                    Test All
                                </button>
                            </div>
                            
                            <div class="connections-list" id="connectionsList">
                                <!-- Connection status will be shown here -->
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Create Job Page -->
                <div id="createJobPage" class="page">
                    <div class="page-header">
                        <div>
                            <p>Create a new migration job with source and target configuration</p>
                        </div>
                        <button class="btn btn-secondary" onclick="navigateToPage('jobs')">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m0 7h18"/>
                            </svg>
                            Back to Jobs
                        </button>
                    </div>
                    
                    <div class="create-job-container">
                        <div class="job-form-header">
                            <h2>Migration Job Details</h2>
                            <p>Configure your migration project settings</p>
                        </div>
                        
                        <div class="job-form-content">
                            <div class="form-section">
                                <div class="form-field">
                                    <label class="field-label">Job Name</label>
                                    <input type="text" id="createJobName" placeholder="E-commerce API Migration" class="form-input liquid-glass">
                                </div>
                                
                                <div class="form-field">
                                    <label class="field-label">Description</label>
                                    <textarea id="createJobDescription" rows="4" placeholder="Migrate our e-commerce API from Spring Boot to modern microservices architecture..." class="form-input liquid-glass"></textarea>
                                </div>
                                
                                <div class="form-row">
                                    <div class="form-field">
                                        <label class="field-label">Source Repository</label>
                                        <div class="select-container">
                                            <select id="createSourceSelect" class="form-input liquid-glass">
                                                <option value="">Choose source repository...</option>
                                            </select>
                                            <div class="select-arrow">
                                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                                                </svg>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="form-field">
                                        <label class="field-label">Target Platform</label>
                                        <div class="select-container">
                                            <select id="createTargetSelect" class="form-input liquid-glass">
                                                <option value="">Choose target platform...</option>
                                            </select>
                                            <div class="select-arrow">
                                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                                                </svg>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-actions">
                                <button class="btn btn-secondary" onclick="navigateToPage('jobs')">Cancel</button>
                                <button class="btn btn-primary" onclick="saveJob()">
                                    <span id="saveJobBtnText">Save Migration Job</span>
                                    <div class="spinner" id="saveJobSpinner" style="display: none;"></div>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
    
    <!-- Modals -->
    <div id="newJobModal" class="modal">
        <div class="modal-content beautiful-modal">
            <div class="modal-header-beautiful">
                <h2>Create Migration Job</h2>
                <button class="close-btn" onclick="closeModal('newJobModal')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            
            <div class="modal-body-beautiful">
                <div class="beautiful-form">
                    <div class="form-field">
                        <label class="field-label">Job Name</label>
                        <input type="text" id="jobName" placeholder="E-commerce API Migration" class="beautiful-input">
                    </div>
                    
                    <div class="form-field">
                        <label class="field-label">Description</label>
                        <textarea id="jobDescription" rows="3" placeholder="Migrate our e-commerce API from Spring Boot to modern microservices..." class="beautiful-input beautiful-textarea"></textarea>
                    </div>
                    
                    <div class="form-row-beautiful">
                        <div class="form-field">
                            <label class="field-label">Source Repository</label>
                            <div class="beautiful-select-container">
                                <select id="sourceSelect" class="beautiful-select">
                                    <option value="">Choose source...</option>
                                </select>
                                <div class="select-icon">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                                    </svg>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-field">
                            <label class="field-label">Target Platform</label>
                            <div class="beautiful-select-container">
                                <select id="targetSelect" class="beautiful-select">
                                    <option value="">Choose target...</option>
                                </select>
                                <div class="select-icon">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                                    </svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="modal-footer-beautiful">
                <button class="btn-beautiful btn-cancel" onclick="closeModal('newJobModal')">Cancel</button>
                <button class="btn-beautiful btn-continue" onclick="createJob()">
                    <span id="createJobBtnText">Continue</span>
                    <div class="loading-spinner" id="createJobSpinner" style="display: none;"></div>
                </button>
            </div>
        </div>
    </div>
    
    <!-- Job Detail Modal -->
    <div id="jobDetailModal" class="modal">
        <div class="modal-content beautiful-timeline-modal">
            <div class="timeline-header">
                <div class="timeline-title-section">
                    <div class="timeline-icon">⚡</div>
                    <div>
                        <h2 id="jobDetailName">Migration Timeline</h2>
                        <p id="jobDetailDescription">Track your migration progress</p>
                    </div>
                </div>
                <button class="close-btn" onclick="closeModal('jobDetailModal')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            
            <div class="timeline-body">
                <div class="timeline-meta">
                    <div class="meta-pill">
                        <span class="meta-icon">📁</span>
                        <span id="jobDetailSource">Source</span>
                    </div>
                    <div class="meta-pill">
                        <span class="meta-icon">🎯</span>
                        <span id="jobDetailTarget">Target</span>
                    </div>
                    <div class="meta-pill">
                        <span class="meta-icon">📅</span>
                        <span id="jobDetailCreated">Created</span>
                    </div>
                </div>
                
                <div class="timeline-container" id="jobStagesContainer">
                    <!-- Timeline items will be populated here -->
                </div>
            </div>
        </div>
    </div>
    
    <!-- Add Source Modal -->
    <div id="addSourceModal" class="modal">
        <div class="modal-content liquid-glass">
            <div class="modal-header">
                <h3>Add New Source</h3>
                <button class="modal-close" onclick="closeModal('addSourceModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="source-type-selector">
                    <label class="source-type-option">
                        <input type="radio" name="sourceType" value="github" checked onchange="toggleSourceTypeFields()">
                        <div class="source-type-card liquid-glass">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/>
                            </svg>
                            <span>GitHub Repository</span>
                        </div>
                    </label>
                    <label class="source-type-option">
                        <input type="radio" name="sourceType" value="local" onchange="toggleSourceTypeFields()">
                        <div class="source-type-card liquid-glass">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/>
                            </svg>
                            <span>Local Folder</span>
                        </div>
                    </label>
                </div>
                
                <div class="form-group">
                    <label>Source Name</label>
                    <input type="text" id="sourceName" placeholder="Enter a descriptive name" class="form-input liquid-glass">
                </div>
                
                <div id="githubFields">
                    <div class="form-group">
                        <label>Repository URL</label>
                        <input type="text" id="repoUrl" placeholder="https://github.com/user/repo.git" class="form-input liquid-glass">
                        <small class="form-hint">Public repositories only (private repos require authentication setup)</small>
                    </div>
                </div>
                
                <div id="localFields" style="display: none;">
                    <div class="form-group">
                        <label>Folder Path</label>
                        <input type="text" id="folderPath" placeholder="/path/to/folder" class="form-input liquid-glass">
                        <small class="form-hint">Enter the absolute path to your local folder</small>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('addSourceModal')">Cancel</button>
                <button class="btn btn-primary" onclick="addSource()">
                    <span id="addSourceBtnText">Add Source</span>
                    <div class="spinner" id="addSourceSpinner" style="display: none;"></div>
                </button>
            </div>
        </div>
    </div>
    
    <!-- Source Tree Modal -->
    <div id="sourceTreeModal" class="modal">
        <div class="modal-content modal-xl liquid-glass" style="max-width: none !important; width: 95vw !important;">
            <div class="modal-header">
                <h3><span id="sourceTreeTitle">Source Tree</span></h3>
                <button class="btn btn-secondary" onclick="closeModal('sourceTreeModal')">Close</button>
            </div>
            <div class="modal-body">
                <div class="tree-split-view">
                    <div class="tree-panel liquid-glass">
                        <div class="tree-navigation" id="treeNavigation">
                            <!-- Navigation breadcrumb will be added here -->
                        </div>
                        <div class="tree-container">
                            <div id="sourceTreeContent" class="file-tree">
                                <!-- Tree will be loaded here -->
                            </div>
                        </div>
                    </div>
                    <div class="content-panel liquid-glass">
                        <div class="content-header liquid-glass" id="contentHeader">
                            <span class="content-filename">Select a file to view</span>
                        </div>
                        <div class="content-body" id="contentBody">
                            <div class="content-placeholder">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                                </svg>
                                <p>Select a file from the tree to view its contents</p>
                            </div>
                            <pre id="fileContent" class="file-content" style="display: none;"></pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Add Target Modal -->
    <div id="addTargetModal" class="modal">
        <div class="modal-content modal-xl liquid-glass" style="max-width: none !important; width: 85vw !important;">
            <div class="modal-header">
                <h3>Add New Target</h3>
                <button class="modal-close" onclick="closeModal('addTargetModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="target-edit-container">
                    <div class="target-info-section">
                        <div class="form-group">
                            <label>Target Name</label>
                            <input type="text" id="targetName" placeholder="e.g., Python FastAPI" class="form-input liquid-glass">
                            <small class="form-hint">Give your target a descriptive name</small>
                        </div>
                        
                        <div class="form-group">
                            <label>Description</label>
                            <textarea id="targetDescription" rows="2" placeholder="e.g., Python frameworks including Django, FastAPI, Flask" class="form-input liquid-glass"></textarea>
                            <small class="form-hint">Brief description of what this target covers</small>
                        </div>
                    </div>
                    
                    <div class="prompts-section">
                        <h4>Conversion Prompts</h4>
                        <div class="tabs">
                            <div class="tab-list" role="tablist">
                                <button class="tab-button active" data-tab="add-analyze" onclick="switchAddTargetTab('add-analyze')">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zM13 19v-8a2 2 0 00-2-2h-2a2 2 0 00-2 2v8a2 2 0 002 2h2a2 2 0 002-2zM21 19v-10a2 2 0 00-2-2h-2a2 2 0 00-2 2v10a2 2 0 002 2h2a2 2 0 002-2z"/>
                                    </svg>
                                    Analyze
                                </button>
                                <button class="tab-button" data-tab="add-plan" onclick="switchAddTargetTab('add-plan')">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"/>
                                    </svg>
                                    Plan
                                </button>
                                <button class="tab-button" data-tab="add-migrate" onclick="switchAddTargetTab('add-migrate')">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"/>
                                    </svg>
                                    Migrate
                                </button>
                                <button class="tab-button" data-tab="add-validate" onclick="switchAddTargetTab('add-validate')">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                    </svg>
                                    Validate
                                </button>
                                <button class="tab-button" data-tab="add-fix" onclick="switchAddTargetTab('add-fix')">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/>
                                    </svg>
                                    Fix
                                </button>
                                <button class="tab-button" data-tab="add-discuss" onclick="switchAddTargetTab('add-discuss')">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>
                                    </svg>
                                    Discuss
                                </button>
                            </div>
                            <div class="tab-panels">
                                <div class="tab-panel active" id="add-analyze-panel">
                                    <textarea id="addPromptAnalyze" rows="4" placeholder="Enter the analyze prompt..." class="form-input liquid-glass"></textarea>
                                </div>
                                <div class="tab-panel" id="add-plan-panel">
                                    <textarea id="addPromptPlan" rows="4" placeholder="Enter the planning prompt..." class="form-input liquid-glass"></textarea>
                                </div>
                                <div class="tab-panel" id="add-migrate-panel">
                                    <textarea id="addPromptMigrate" rows="4" placeholder="Enter the migration prompt..." class="form-input liquid-glass"></textarea>
                                </div>
                                <div class="tab-panel" id="add-validate-panel">
                                    <textarea id="addPromptValidate" rows="4" placeholder="Enter the validation prompt..." class="form-input liquid-glass"></textarea>
                                </div>
                                <div class="tab-panel" id="add-fix-panel">
                                    <textarea id="addPromptFix" rows="4" placeholder="Enter the fix prompt..." class="form-input liquid-glass"></textarea>
                                </div>
                                <div class="tab-panel" id="add-discuss-panel">
                                    <textarea id="addPromptDiscuss" rows="4" placeholder="Enter the discussion prompt..." class="form-input liquid-glass"></textarea>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('addTargetModal')">Cancel</button>
                <button class="btn btn-primary" onclick="addTarget()">
                    <span id="addTargetBtnText">Create Target</span>
                    <div class="spinner" id="addTargetSpinner" style="display: none;"></div>
                </button>
            </div>
        </div>
    </div>
    
    <!-- Edit Target Modal -->
    <div id="editTargetModal" class="modal">
        <div class="modal-content modal-xl liquid-glass" style="max-width: none !important; width: 85vw !important;">
            <div class="modal-header">
                <h3><span id="editTargetTitle">Edit Target</span></h3>
                <button class="btn btn-secondary" onclick="closeModal('editTargetModal')">Close</button>
            </div>
            <div class="modal-body">
                <div class="target-edit-container">
                    <div class="target-info-section">
                        <div class="form-group">
                            <label>Target Name</label>
                            <input type="text" id="editTargetName" class="form-input liquid-glass">
                        </div>
                        <div class="form-group">
                            <label>Description</label>
                            <textarea id="editTargetDescription" rows="2" class="form-input liquid-glass"></textarea>
                        </div>
                    </div>
                    
                    <!-- Main tabs for Conversion Prompts and Knowledge Store -->
                    <div class="main-tabs">
                        <div class="main-tab-list" role="tablist">
                            <button class="main-tab-button active" data-main-tab="prompts" onclick="switchMainTab('prompts')">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                                </svg>
                                Conversion Prompts
                            </button>
                            <button class="main-tab-button" data-main-tab="knowledge" onclick="switchMainTab('knowledge')">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"/>
                                </svg>
                                Knowledge Store
                            </button>
                        </div>
                        
                        <!-- Conversion Prompts Tab Content -->
                        <div class="main-tab-panel active" id="prompts-panel">
                            <div class="prompts-section">
                                <div class="tabs">
                                    <div class="tab-list" role="tablist">
                                <button class="tab-button active" data-tab="analyze" onclick="switchTab('analyze')">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zM13 19v-8a2 2 0 00-2-2h-2a2 2 0 00-2 2v8a2 2 0 002 2h2a2 2 0 002-2zM21 19v-10a2 2 0 00-2-2h-2a2 2 0 00-2 2v10a2 2 0 002 2h2a2 2 0 002-2z"/>
                                    </svg>
                                    Analyze
                                </button>
                                <button class="tab-button" data-tab="plan" onclick="switchTab('plan')">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"/>
                                    </svg>
                                    Plan
                                </button>
                                <button class="tab-button" data-tab="migrate" onclick="switchTab('migrate')">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"/>
                                    </svg>
                                    Migrate
                                </button>
                                <button class="tab-button" data-tab="validate" onclick="switchTab('validate')">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                    </svg>
                                    Validate
                                </button>
                                <button class="tab-button" data-tab="fix" onclick="switchTab('fix')">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.121 14.121L19 19m-7-7l7-7m-7 7l-2.879 2.879M12 12L9.121 9.121m0 5.758a3 3 0 10-4.243 4.243 3 3 0 004.243-4.243z"/>
                                    </svg>
                                    Fix
                                </button>
                                <button class="tab-button" data-tab="discuss" onclick="switchTab('discuss')">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>
                                    </svg>
                                    Discuss
                                </button>
                            </div>
                            
                            <div class="tab-content">
                                <div class="tab-panel active" data-panel="analyze">
                                    <label>Analyze Prompt</label>
                                    <textarea id="promptAnalyze" rows="4" class="form-input liquid-glass prompt-textarea"></textarea>
                                    <small class="form-hint">Prompt for analyzing source code architecture and patterns</small>
                                </div>
                                <div class="tab-panel" data-panel="plan">
                                    <label>Plan Prompt</label>
                                    <textarea id="promptPlan" rows="4" class="form-input liquid-glass prompt-textarea"></textarea>
                                    <small class="form-hint">Prompt for creating migration plan</small>
                                </div>
                                <div class="tab-panel" data-panel="migrate">
                                    <label>Migrate Prompt</label>
                                    <textarea id="promptMigrate" rows="4" class="form-input liquid-glass prompt-textarea"></textarea>
                                    <small class="form-hint">Prompt for converting code to target framework</small>
                                </div>
                                <div class="tab-panel" data-panel="validate">
                                    <label>Validate Prompt</label>
                                    <textarea id="promptValidate" rows="4" class="form-input liquid-glass prompt-textarea"></textarea>
                                    <small class="form-hint">Prompt for validating migrated code</small>
                                </div>
                                <div class="tab-panel" data-panel="fix">
                                    <label>Fix Prompt</label>
                                    <textarea id="promptFix" rows="4" class="form-input liquid-glass prompt-textarea"></textarea>
                                    <small class="form-hint">Prompt for fixing issues in migrated code</small>
                                </div>
                                <div class="tab-panel" data-panel="discuss">
                                    <label>Discuss Prompt</label>
                                    <textarea id="promptDiscuss" rows="4" class="form-input liquid-glass prompt-textarea"></textarea>
                                    <small class="form-hint">Prompt for discussing migration approaches</small>
                                </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Knowledge Store Tab Content -->
                        <div class="main-tab-panel" id="knowledge-panel">
                            <div class="knowledge-store-section">
                                <!-- Knowledge Store Sub-tabs -->
                                <div class="knowledge-tabs">
                                    <div class="knowledge-tab-list" role="tablist">
                                        <button class="knowledge-tab-button active" data-knowledge-tab="search" onclick="switchKnowledgeTab('search')">
                                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                                            </svg>
                                            Search Topics
                                        </button>
                                        <button class="knowledge-tab-button" data-knowledge-tab="samples" onclick="switchKnowledgeTab('samples')">
                                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                                <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                                            </svg>
                                            GitHub Samples
                                        </button>
                                        <button class="knowledge-tab-button" data-knowledge-tab="docs" onclick="switchKnowledgeTab('docs')">
                                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                                            </svg>
                                            Docs & Files
                                        </button>
                                    </div>
                                    
                                    <!-- Search Topics Tab Panel -->
                                    <div class="knowledge-tab-panel active" data-knowledge-panel="search">
                                        <div class="knowledge-section">
                                            <div class="knowledge-input-group">
                                                <input type="text" id="searchTopicInput" placeholder="e.g., FastAPI best practices, React hooks patterns" class="form-input liquid-glass">
                                                <button class="btn btn-primary liquid-glass" onclick="addSearchTopic()">
                                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                                                    </svg>
                                                    Add Topic
                                                </button>
                                            </div>
                                            <small class="form-hint">Add topics for the agent to research automatically</small>
                                        </div>
                                    </div>
                                    
                                    <!-- GitHub Samples Tab Panel -->
                                    <div class="knowledge-tab-panel" data-knowledge-panel="samples">
                                        <div class="knowledge-section">
                                            <div class="knowledge-input-group">
                                                <input type="url" id="githubUrlInput" placeholder="https://github.com/user/repo or specific file URL" class="form-input liquid-glass">
                                                <button class="btn btn-primary liquid-glass" onclick="addGithubSample()">
                                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                                                    </svg>
                                                    Add Sample
                                                </button>
                                            </div>
                                            <small class="form-hint">Add GitHub repositories or specific code examples</small>
                                        </div>
                                    </div>
                                    
                                    <!-- Docs & Files Tab Panel -->
                                    <div class="knowledge-tab-panel" data-knowledge-panel="docs">
                                        <div class="knowledge-section">
                                            <!-- Documentation URLs -->
                                            <div class="knowledge-subsection">
                                                <h6>Documentation Links</h6>
                                                <div class="knowledge-input-group">
                                                    <input type="url" id="docUrlInput" placeholder="https://docs.example.com/api-reference" class="form-input liquid-glass">
                                                    <button class="btn btn-primary liquid-glass" onclick="addDocumentationUrl()">
                                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                                                        </svg>
                                                        Add URL
                                                    </button>
                                                </div>
                                            </div>
                                            
                                            <!-- File Upload -->
                                            <div class="knowledge-subsection">
                                                <h6>Local Files</h6>
                                                <div class="knowledge-upload-area liquid-glass" onclick="triggerFileUpload()">
                                                    <input type="file" id="knowledgeFileInput" multiple accept=".pdf,.md,.txt,.doc,.docx" style="display: none;" onchange="handleFileUpload(event)">
                                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/>
                                                    </svg>
                                                    <p>Drop files here or click to browse</p>
                                                    <small>PDF, MD, TXT, DOC, DOCX files supported</small>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                    
                                    <!-- Knowledge Items List (hidden) -->
                                    <div id="knowledgeStoreList" class="knowledge-list" style="display: none;">
                                        <!-- Knowledge store items will be listed here -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('editTargetModal')">Cancel</button>
                <button class="btn btn-primary" onclick="saveTarget()">
                    <span id="saveTargetBtnText">Save Changes</span>
                    <div class="spinner" id="saveTargetSpinner" style="display: none;"></div>
                </button>
            </div>
        </div>
    </div>
    
    <!-- Add Agent Modal -->
    <div id="addAgentModal" class="modal">
        <div class="modal-content liquid-glass" style="max-width: 600px;">
            <div class="modal-header">
                <h3>Add New Agent</h3>
                <button class="close-btn" onclick="closeModal('addAgentModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Agent Name</label>
                    <input type="text" id="newAgentName" class="form-control" placeholder="e.g., Custom Code Architect">
                </div>
                
                <div class="form-group">
                    <label>Role</label>
                    <select id="newAgentRole" class="form-control" onchange="updateCapabilitiesSuggestions()">
                        <option value="custom">Custom</option>
                        <option value="architect">Code Architect</option>
                        <option value="engineer">Code Engineer</option>
                        <option value="writer">Technical Writer</option>
                        <option value="manager">Project Manager</option>
                        <option value="scrum_master">Scrum Master</option>
                        <option value="devops">DevOps Engineer</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Description</label>
                    <textarea id="newAgentDescription" class="form-control" rows="3" placeholder="Describe the agent's responsibilities..."></textarea>
                </div>
                
                <div class="form-group">
                    <label>Avatar (Emoji)</label>
                    <input type="text" id="newAgentAvatar" class="form-control" placeholder="e.g., 🤖" maxlength="2">
                </div>
                
                <div class="form-group">
                    <label>Capabilities</label>
                    <div id="capabilitiesSection" class="capabilities-section">
                        <!-- Capabilities will be loaded dynamically -->
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('addAgentModal')">Cancel</button>
                <button class="btn btn-primary" onclick="createAgent()">Create Agent</button>
            </div>
        </div>
    </div>
    
    <!-- Add Credential Modal -->
    <div id="addCredentialModal" class="modal">
        <div class="modal-content credential-modal">
            <div class="credential-modal-header">
                <h3>Add New Credential</h3>
                <button class="close-btn" onclick="closeModal('addCredentialModal')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            
            <div class="credential-modal-body">
                <div class="credential-type-selector">
                    <h4>Select Credential Type</h4>
                    <div class="credential-search-box">
                        <input type="text" id="credentialTypeSearch" placeholder="Search credential types..." class="form-input" onkeyup="filterCredentialTypes()">
                    </div>
                    <div id="credentialTypesContainer">
                        <!-- Credential types will be loaded dynamically by category -->
                        <div class="loading-spinner">Loading credential types...</div>
                    </div>
                </div>
                
                <div class="credential-form" id="credentialForm" style="display: none;">
                    <div class="form-group">
                        <label>Credential Name</label>
                        <input type="text" id="credentialName" placeholder="e.g., jira-prod, slack-dev" class="form-input">
                        <small class="form-hint">Give it a memorable name to reference it later</small>
                    </div>
                    
                    <div id="credentialFields">
                        <!-- Dynamic fields will be loaded here based on type -->
                    </div>
                </div>
            </div>
            
            <div class="credential-modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('addCredentialModal')">Cancel</button>
                <button class="btn btn-primary" onclick="saveCredential()" id="saveCredentialBtn" disabled>
                    <span id="saveCredentialBtnText">Save Credential</span>
                    <div class="spinner" id="saveCredentialSpinner" style="display: none;"></div>
                </button>
            </div>
        </div>
    </div>
    
    <!-- Edit Agent Modal -->
    <div id="editAgentModal" class="modal">
        <div class="modal-content liquid-glass" style="max-width: 600px;">
            <div class="modal-header">
                <h3>Edit Agent</h3>
                <button class="close-btn" onclick="closeModal('editAgentModal')">&times;</button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="editAgentId">
                
                <div class="form-group">
                    <label>Agent Name</label>
                    <input type="text" id="editAgentName" class="form-control">
                </div>
                
                <div class="form-group">
                    <label>Description</label>
                    <textarea id="editAgentDescription" class="form-control" rows="3"></textarea>
                </div>
                
                <div class="form-group">
                    <label>Avatar (Emoji)</label>
                    <input type="text" id="editAgentAvatar" class="form-control" maxlength="2">
                </div>
                
                <div class="form-group">
                    <label>Status</label>
                    <select id="editAgentStatus" class="form-control">
                        <option value="active">Active</option>
                        <option value="inactive">Inactive</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Capabilities</label>
                    <div id="editCapabilitiesSection" class="capabilities-section">
                        <!-- Capabilities will be loaded dynamically -->
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-danger" onclick="deleteAgent()" style="margin-right: auto;">Delete Agent</button>
                <button class="btn btn-secondary" onclick="closeModal('editAgentModal')">Cancel</button>
                <button class="btn btn-primary" onclick="updateAgent()">Save Changes</button>
            </div>
        </div>
    </div>
    
    <script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
</body>
</html>